# This workflow will do a clean install of node dependencies, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: Node.js CI
on:
  schedule:
  - cron:  '0 9 * * *'

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [10.x]
    steps:
    - uses: actions/checkout@v2
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ matrix.node-version }}
    - name: Install 
      run: cd scripts; npm install
    - name: USA
      run: |
        cd scripts
        node usa.js 
    - name: "Commit downloaded files" 
      uses: stefanzweifel/git-auto-commit-action@v4
      with:
        # Optional but recommended
        # Defaults to "Apply automatic changes"
        commit_message: Dayly update dataset

        # Optional branch name where commit should be pushed to
        # Defaults to the current branch
        #branch: feature-123

        # Optional options appended to `git-commit`
        # See https://git-scm.com/docs/git-commit for a list of available options
        #commit_options: '--no-verify --signoff'
        
        # Optional glob pattern of files which should be added to the commit
        # Defaults to all (.)
        # See the `pathspec`-documentation for git
        # - https://git-scm.com/docs/git-add#Documentation/git-add.txt-ltpathspecgt82308203
        # - https://git-scm.com/docs/gitglossary#Documentation/gitglossary.txt-aiddefpathspecapathspec
        #file_pattern: raw/*

        # Optional local file path to the repository
        # Defaults to the root of the repository
        repository: .

        # Optional commit user and author settings
        commit_user_name: VaccineBot # defaults to "GitHub Actions"
        commit_user_email: no-reply@merlos.org # defaults to "actions@github.com"
        commit_author: Vaccine Bot <no-reply@merlos.org> # defaults to author of the commit that triggered the run

        # Optional tag message 
        # Action will create and push a new tag to the remote repository and the defined branch
        #tagging_message: 'v1.0.0'

        # Optional options appended to `git-push`
        # See git-push documentation for details: https://git-scm.com/docs/git-push#_options
        #push_options: '--force'
    
        # Optional: Disable dirty check and always try to create a commit and push
        #skip_dirty_check: true    
    
        # Optional: Skip internal call to `git fetch`
        #skip_fetch: true
